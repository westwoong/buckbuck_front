<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>BuckBuck</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="header">
    <div class="title">BuckBuck</div>
    <div class="buttons">
        <button id="loginButton">로그인</button>
        <button id="signupButton">회원가입</button>
        <button id="logoutButton" style="display: none;">로그아웃</button>
    </div>
</div>
<div class="forum">
    <div class="forum-header">
        <div class="title">제목</div>
        <div class="writer">글쓴이</div>
        <div class="date">작성일</div>
        <div class="views">조회</div>
        <div class="likes">추천</div>
    </div>
    <div id="postList" class="forum-post">
        <script>
            fetch('http://localhost:3000/posts?page=1')
                .then(response => response.json())
                .then(data => {
                    const postList = document.getElementById('postList');
                    data.posts.forEach(post => {
                        const postItem = document.createElement('div');
                        postItem.classList.add('forum-post');
                        postItem.innerHTML = `
                <div class="title"><a href="post_detail.html?id=${post.id}">${post.title}</a></div>
                <div class="writer">${post.nickName}</div>
                <div class="date">${new Date(post.createdAt).toLocaleDateString()}</div>
                <div class="views">-</div>
                <div class="likes">-</div>
            `;
                        postList.appendChild(postItem);
                    });
                })
                .catch(error => console.error('Error fetching posts:', error));
        </script>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const token = localStorage.getItem('token');

        if (token) {
            // 토큰이 있으면 로그아웃 표시
            document.getElementById('logoutButton').style.display = 'block';
            document.getElementById('loginButton').style.display = 'none';
        } else {
            // 토큰이 없으면 로그인 표시
            document.getElementById('logoutButton').style.display = 'none';
            document.getElementById('loginButton').style.display = 'block';
        }
    });

    // 로그아웃
    document.getElementById('logoutButton').addEventListener('click', function () {
        localStorage.removeItem('token');
        alert('로그아웃 되었습니다')
        location.reload();
    });

    document.getElementById('loginButton').addEventListener('click', function () {
        window.location.href = 'login.html';
    });

    document.getElementById('signupButton').addEventListener('click', function () {
        window.location.href = 'signup.html';
    });
</script>

</body>
</html>
